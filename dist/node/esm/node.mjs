import{inspect as d}from"node:util";import{open as I,writeFile as P}from"node:fs/promises";var O=new Set(["log","info","warn","error"]),a=[["Sunday","Sun"],["Monday","Mon"],["Tuesday","Tue"],["Wednesday","Wed"],["Thursday","Thu"],["Friday","Fri"],["Saturday","Sat"]],y=(n,r)=>{return(r instanceof Map?[...r]:Object.entries(r)).reduce((c,[s,e])=>c.replaceAll(s,e),n)},f=(n,r,o,c="{{processed_data}}")=>{let s=r.data.map((p)=>o(n,p)).join(`
`),e=new Date(r.timestamp),i=e.toISOString(),[w,L]=i.slice(0,-1).split("T");return y(c,{"{{log_type}}":r.type,"{{processed_data}}":s,"{{timestamp}}":String(Math.floor(r.timestamp)),"{{timestamp_precise}}":String(r.timestamp),"{{iso_date}}":i,"{{date}}":w,"{{time}}":L,"{{JJ}}":a[e.getDay()][0].toUpperCase(),"{{jj}}":a[e.getDay()][0],"{{J}}":a[e.getDay()][1].toUpperCase(),"{{j}}":a[e.getDay()][1],"{{YYYY}}":e.getFullYear().toString(),"{{YY}}":e.getFullYear().toString().slice(-2),"{{MM}}":e.getMonth().toString().padStart(2,"0"),"{{M}}":e.getMonth().toString(),"{{dd}}":e.getDate().toString().padStart(2,"0"),"{{HH}}":e.getHours().toString().padStart(2,"0"),"{{hh}}":(e.getHours()%12).toString().padStart(2,"0"),"{{mm}}":e.getMinutes().toString().padStart(2,"0"),"{{ss}}":e.getSeconds().toString().padStart(2,"0"),"{{H}}":e.getHours().toString(),"{{h}}":(e.getHours()%12).toString(),"{{m}}":e.getMinutes().toString(),"{{s}}":e.getSeconds().toString(),"{{ms++}}":e.getMilliseconds().toString().padStart(3,"0"),"{{ms+}}":e.getMilliseconds().toString().padStart(2,"0"),"{{ms}}":e.getMilliseconds().toString(),"{{PP}}":e.getHours()>=12?"PM":"AM","{{pp}}":e.getHours()>=12?"pm":"am","{{P}}":e.getHours()>=12?"P":"M","{{p}}":e.getHours()>=12?"p":"m"})};var h=(n,r,o)=>{if(typeof o==="string")return o;return d(o,{...r,colors:!1})},F=(n)=>{let r=n.template??"{{processed_data}}",o=Object.assign({},n.inspectOptions??{},{colors:!0}),c=(s,e)=>h(s,o,e);return n.clearPreviousLogs&&console.clear(),(s,e)=>{if(O.has(e.type))console[e.type](f(s,e,c,r));else console.log(f(s,e,c,r))}},A=async(n,r={})=>{let o=await I(n,"a"),c=[],s={template:r.template??"{{processed_data}}",clearPreviousLogs:r.clearPreviousLogs??!1,inspectOptions:Object.assign({},r.inspectOptions??{},{colors:!1})},e=(p,t)=>h(p,s.inspectOptions,t),i=!0,w=async(p)=>{i=!1;while(c.length>0){let t=c.shift();if(!t)continue;await o.write(f(p,t,e,s.template)+`
`).catch((m)=>{return console.error("An error occurred while writing to the log file.",{logger:p,log:t,error:m}),null})}i=!0};if(s.clearPreviousLogs)await P(n,"").catch((p)=>{console.error("An error occurred while clearing the log file.",{error:p})});let L=(p,t)=>{c.push(t),i&&w(p)};return L.close=async()=>await o.close(),L};export{A as createLogFileWriter,F as createConsoleWriter};

//# debugId=738DF34A5C2B982064756E2164756E21
//# sourceMappingURL=node.mjs.map
